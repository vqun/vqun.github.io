<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Menu</title>
	<link rel="stylesheet" href="./menu.css">
	<link rel="stylesheet" type="text/css" href="../../css/thinking.css">
</head>
<body>
<div class="section">
	<h3>Example One: Easiest</h3>
	<div class="menu">
		<ul id="menu1">
			<li class="item"><a href="#">Home</a></li>
			<li class="item">
				<a href="#">Hot▼</a>
				<ul class="subMenu" style="display:none;">
					<li class="subItem"><a href="#">HotWeibo</a></li>
					<li class="subItem"><a href="#">Topic</a></li>
					<li class="subItem"><a href="#">Welfare</a></li>
				</ul>
			</li>
			<li class="item"><a href="#">Apps</a></li>
			<li class="item">
				<a href="#">Games▼</a>
				<ul class="subMenu" style="display:none;">
					<li class="subItem"><a href="#">女神联盟</a></li>
					<li class="subItem"><a href="#">火影传说</a></li>
					<li class="subItem"><a href="#">天才樱木</a></li>
					<li class="subItem"><a href="#">暗黑西游OL</a></li>
				</ul>
			</li>
			<br class="clear" />
		</ul>
	</div>
</div>

<div class="thinking">
	<h2>基本思路</h2>
	<ol>
		<li>搞两个定时器clearTimeout，一个用来记录显示二级菜单showTid，一个用来记录隐藏二级菜单hideTid</li>
		<li>搞个currShow记录当前显示的二级菜单</li>
		<li>mouseover：clearTimeout(hideTid)，干掉隐藏</li>
		<li>拿到被over元素对应的二级菜单，判断是否是当前显示的currShow，然后，，，，你懂的。。</li>
		<li>mouseout：clearTimeout(showTid)，干掉显示</li>
		<li>其他：比如，干掉显示时要做blablabla。。。都忒么是浮云了，就不纠结.......<em>PO主真的很懒，没办法</em></li>
	</ol>
</div>
</body>
<script type="text/javascript" src="../../saber/base.js"></script>
<script type="text/javascript">
	var ul = S.$('menu1');
	S.on(ul, 'mouseover', showMenu);
	S.on(ul, 'mouseout', hideMenu);
	var showTid = 0, hideTid = 0;
	var currShow = null;
	function showMenu(evt) {
		clearTimeout(hideTid);
		evt = evt || event;
		var el = evt.target || evt.srcElement;
		showTid = setTimeout(function() {
			var subMenu = getSubmenu(el)
			if(currShow && subMenu !== currShow) currShow.style.display = 'none';
			subMenu && (currShow = subMenu) && (subMenu.style.display = '');
			subMenu = null;
		}, 200)
	}
	function hideMenu(evt) {
		clearTimeout(showTid);
		evt = evt || event;
		var el = evt.target || evt.srcElement;
		hideTid = setTimeout(function() {
			var subMenu = getSubmenu(el)
			subMenu && !(currShow = null) && (subMenu.style.display = 'none');
			subMenu = null;
		}, 200)
	}
	function getSubmenu(el) {
		while(!!el && el.nodeType === 1 && (el.tagName.toLowerCase()!== 'li' || el.className !== 'item')) {
			el = el.parentNode
		}
		return S.C('subMenu', el)[0];
	}
</script>
</html>