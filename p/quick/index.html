<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>QuickSort</title>
	<link rel="stylesheet" type="text/css" href="../../css/thinking.css">
    <link rel="stylesheet" type="text/css" href="../../css/plugins/codeHighlight.css">
</head>
<body>
<div class="thinking">
	<h2>快速排序</h2>
	<h3><em>P.S.</em>使用<em>首尾同时查找</em>方式，仅在都找到大于和小于基准值时，再做交换操作，以便减少交换次数；对于JS，这点尤其重要，特别是在操作DOM时候，减少交换次数可以极大提升性能</h3>
	<h3><em>P.S.</em>此处的排序是升序排序，想要用降序，只需要将程序中的partition函数中的大于和小于互换即可；并且，排序影响源数据（呵呵，要想不影响，换一换就可以了）</h3>
    <div id="codeContainer"></div>
</div>
<textarea style="display:none;" id="codes">
var test = [10, 5, 6, 41, 98, 25, 3, 65, 32,78, 12, 32, 54, 65];
alert("快速排序：\n"+quickSort(test).join(" < "))
// 递归调用
function quickSort(arr, low, high) {
	if(low == undefined) low = 0;
	if(high == undefined) high = arr.length-1;
	// 越界时，说明分区已经排序成功
	if(low>=high){
	    return true
	}
	var p = partition(arr, low, high);
	arguments.callee(arr, low, p-1);
	arguments.callee(arr, p+1, high);
	return arr
}
// 分区，以起始值arr[low]作为基准值
function partition(arr, low, high) {
	var base = arr[low];
	var i = low+1,
		j = high,
		time = high - low;
	var less = null, great = null;
	while(time) {
		arr[j] < base ? (less = j) : --j;
		arr[i] > base ? (great = i) : ++i;
		// 小于和大于基准值都找到时，做交换处理
		if(less && great !== null) {
        	exchange(arr, less, great);
        	less = great = null;
        	--j;
        	++i
		}
		// 处理查找越界情况
		if(j<=i) {
			if(arr[i]>base) {
			    i--
			}
			break
		}
		--time;
	}
	// 分区结束后，将基准值放到分区边界处
	exchange(arr, low, i)
	return i
}
function exchange(arr, i, j) {
	var tmp = arr[i];
	arr[i] = arr[j];
	arr[j] = tmp
}
</textarea>
</body>
<script type="text/javascript" src="../../saber/utils.js"></script>
<script type="text/javascript" src="../../js/plugins/codeHighlight.js"></script>
<script type="text/javascript" src="quickSort.js"></script>
<script type="text/javascript">
    (function($){
        var codes = $.id("codes");
        var container = $.id("codeContainer");
        var codes = new Saber.CodeHighlight(codes, {
        	"indent": 2
        });
        codes.line("<div class=\"line\">${code}</div>").render(container)
    })(Saber)
</script>
</html>