/*
 *@name Saber.Base
 *@version v0.1.0
 *@desc An Easy Library used for https://vqun.github.io
 *@author VeeQun
 *@license MIT
 *@date 2014-05-02
 */
!function(global,undefined){function register(a,b,c){if("string"!=typeof a)return!1;a=a.split(".");for(var d=S,e=null;e=a.shift();){if(!a.length)return d[e]===undefined&&(d[e]=b.call(S,S)),!!c&&(S[c]=d[e]),!0;d[e]===undefined&&(d[e]={}),d=d[e]}return!1}function addDash(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}function removeDash(a){var b=a.split("-"),c=null,d=1;return b[0]||"ms"!=b[1]&&"webkit"!=b[1]||(d=2),c=S.forEach(b.slice(d),function(a,b){return FirstUpper(b)}),c.splice(0,0,b[d-1]),c.join("")}function evtAccess(a,b,c,d){if(!S.isNode(a)||!b||!S.is(c,"function"))return!1;var e=!d&&"addEventListener"||"removeEventListener";try{a[e](b,c,!0)}catch(f){try{e=!d&&"attachEvent"||"detachEvent",a[e]("on"+b,c)}catch(g){a["on"+b]=c}}}function FirstUpper(a){return S.is(a,"string")?a.replace(/(^.)(.*)/,function(a,b,c){return b.toUpperCase()+c}):a}global.Saber=global.saber=global.S={};var S=global.Saber,ArraySlice=Array.prototype.slice,ObjToString=Object.prototype.toString;S.register=register,register("All",function(){return document.getElementsByTagName("*")}),register("dom.id",function(){return function(a){return document.getElementById(a)}},"id"),register("dom.id",null,"$"),register("dom.tag",function(){return function(a,b){return b=b||document,b.getElementsByTagName(a)}},"T"),register("dom.isNode",function(){return function(a){return!!a&&1===a.nodeType}},"isNode"),register("util.is",function(a){var b=a.isNode;return function(a,c){if("node"===c.toLowerCase())return b(a);var d=ObjToString.call(a).slice(8,-1);return d.toLowerCase()===c.toLowerCase()}},"is"),register("util.trim",function(a){var b=a.is;return function(a){return b(a,"string")?a.replace(/^\s+|\s+$/,""):a}},"trim"),register("util.clear",function(a){var b=a.is;return function(a){return b(a,"string")?a.replace(/\s+/g,""):a}},"clear"),register("util.cls",function(a){var b=a.is,c=a.isNode,d=a.trim;return function(a,e){var f=[];if(!b(a,"string"))return f;a=d(a);try{var g=e&&c(e)&&e.getElementsByClassName(a)||[];f=ArraySlice.call(g)}catch(h){for(var i=e&&c(e)&&e.getElementsByTagName("*")||S.All,j=0,k=null,l=new RegExp("\\b"+a+"\\b");k=i[j];)l.test(k.className)&&f.push(k),++j;i=k=null}return f}},"C"),register("util.IE",function(){return+navigator.userAgent.replace(/.*?MSIE\s+(\d+\.\d*).*/,"$1")||0},"IE"),register("util.indexOf",function(a){var b=a.is;return function(a,c){if(b(c,"string")||b(c,"array")&&c.indexOf)return c.indexOf(a);for(var d=0,e=c.length;e>d;d++)if(a===c[d])return d}},"indexOf"),register("util.forEach",function(a){var b=a.is;return function(a,c,d){if(b(a,"array"))for(var e=[],f=0,g=a.length;g>f;f++)e.push(c(f,a[f]));else if(b(d,"array")){e=[];for(var h in a)e.push(c(h,a[h]))}else{e={};for(var h in a)e[h]=c(h,a[h])}return e}},"forEach"),register("util.emptyFunc",function(){return function(){}},"emptyFunc"),register("util.parseParam",function(a){var b=a.forEach;return function(a,c){return b(a,function(a,b){return c[a]||b})}},"parseParam"),register("dom.style",function(a){var b=a.isNode,c=a.IE;return function(a,d,e){if(!b(a))return"";var f="";if(e!=undefined){if(c&&9>c)switch(d){case"opacity":return a.style.filter="alpah(opacity="+100*+e+")",a.currentStyle&&a.currentStyle.hasLayout||(a.style.zoom=1),e;case"float":d="styleFloat"}else"float"==d&&(d="cssFloat");return a.style[d]=e}if(c&&9>c)switch(f=100,d){case"opacity":try{f=a.filters.alpha.opacity}catch(g){try{f=a.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(g){}}return f/100;case"float":d="styleFloat"}else"float"==d&&(d="cssFloat");var h=a.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(a,null);return f=h[d],("width"==d||"height"==d)&&(d="width"==d?"offsetWidth":"offsetHeight",f="auto"===f?a[d]:f),f||""}},"style"),register("dom.cssFormat",function(a){var b=a.forEach;return function(a,c){var d={};return c="undefined"!=typeof c?c:!0,b(a,function(a,b){return c&&!/\-/.test(a)?(d[addDash(a)]=b,b):d[a]=b}),d}},"cssFormat"),register("dom.cssParser",function(a){var b=a.cssFormat,c=a.forEach,d=a.IE;return function(a){var e=";",f=b(a,!0),g=c(f,function(a,b){return"opacity"==a&&d&&9>d&&(a="filter",b="alpha(opacity="+100*+b+")"),a+":"+b},[]);return e+g.join(";")}},"cssParser"),register("dom.styles",function(a){var b=a.isNode,c=a.style,d=a.cssParser,e=a.forEach;return function(a,f,g){if(!b(a))return{};if(g){var h=a.style.cssText;return a.style.cssText=h+d(f)}return e(f,function(b){return c(a,b)})}},"styles"),register("dom.cssUnits",function(a){var b=/fontSize|height|width|left|top|padding|margin|right|bottom|radius/i,c=a.forEach,d=a.is;return function(a){var e={};return e.add=function(){return c(a,function(a,c){var e=c;return b.test(a)&&d(c,"number")&&(e+="px"),e})},e.remove=function(){return c(a,function(a,c){return b.test(a)?parseFloat(c)||0:c})},e}},"cssUnits"),register("dom.cssText",function(a){var b=a.isNode,c=a.trim,d=a.forEach,e=a.cssUnits,f=a.cssParser;return function(a){if(!b(a))return null;var g=a.style.cssText.split(";"),h={};for(var i in g){var j=g[i].split(":");2==j.length&&(h[removeDash(c(j[0]).toLowerCase())]=c(j[1]))}var k={};return k.push=function(a){return d(a,function(a,b){return h[a]=b,b}),this},k.toString=function(){return h=e(h).add(),f(h)},k}},"cssText"),register("dom.first",function(a){var b=a.isNode;return function(a){if(!b(a))return null;var c=null;return c=a.firstElementChild||function(a){for(var b=a;(c=b.firstChild)&&1!==c.nodeType;)b=c;return c}(a)}},"first"),register("evt.on",function(){return function(a,b,c){return evtAccess(a,b,c)}},"on"),register("evt.off",function(){return function(a,b,c){return evtAccess(a,b,c,1)}},"off"),register("str.firstUpper",function(){return FirstUpper},"firstUpper"),register("io.Http",function($){function Http(){this.xhr=XHR()}function XHR(){var a=null;try{a=new XMLHttpRequest}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){a=null}}}return a}function getResponse(type,xhr){var res=null;return"json"==type?res=xhr.responseText&&$.is(xhr.responseText,"string")?eval("("+xhr.responseText+")"):{}:"text"==type?res=xhr.responseText:"xml"==type&&(res=xhr.responseXML),res}var CONFIG={method:"GET",data:{},charset:"UTF-8",type:"json",ansyc:!0,header:{},success:$.emptyFunc,fail:$.emptyFunc,requesting:$.emptyFunc,timeout:6e4};return Http.prototype.request=function(a,b){if(!a&&!$.is(a,"string"))throw new Error("Need A Request URL");var c=this.xhr||XHR();if(!c)return!1;var d=$.parseParam(CONFIG,b);d.method=d.method.toUpperCase(),d.header["Content-Type"]||(d.header["Content-Type"]="application/x-www-form-urlencoded"),d.header["X-Requested-With"]||(d.header["X-Requested-With"]="XMLHttpRequest");var e=!("GET"!=d.method),f=$.forEach(d.data,function(a,b){return a+"="+b},[]).join("&"),g=setTimeout(function(){c.abort(),d.fail(null,c)},d.timeout);d.ansyc&&(c.onreadystatechange=function(){if(4==c.readyState){clearTimeout(g);var a=getResponse(d.type,c);c.status>=200&&c.status<400?d.success(a,c):d.fail(null,c)}else d.requesting(c.readyState)}),c.open(d.method,a+(e&&f?"?"+f:""),d.ansyc),$.forEach(d.header,function(a,b){return c.setRequestHeader(a,b),b}),c.send(e?null:f)},Http.prototype.abort=function(){this.xhr.abort()},Http.request=function(a,b){var c=new Http;return c.request(a,b),c},Http},"Http")}(this),function(a){function b(b,d,h){if(!g(b,"Node"))throw"Animate Need a Node as the first argument";h=g(h,"string")&&h||"linear",d=i({duration:500,frameTime:25,start:a.emptyFunc,end:a.emptyFunc},d);var n=this.algorithm.use(h),o={},p={playID:0,target:null,status:"non-start"};return o.play=function(a){if(!p||"playing"==p.status)return!1;p.status="playing",p.target=a;var h=(new Date).getTime(),i=l(b),q=m(k(b,a)).remove(),r=a,s=d.duration;d.start(b),p.playID=setTimeout(function(){if(now=(new Date).getTime()-h,now>=s)return b.style.cssText=i.push(r).toString(),d.end.call(o,b),!0;var k=j(a,function(a,b){var d=e(a,q[a]),h=e(a,b),i=0;return g(d,"array")?i=f(d,h,n,s,now):(i=c.apply(n,[d,0,h,s,now]),0!==i&&isNaN(i)?b:i)});b.style.cssText=i.push(k).toString(),p.playID=setTimeout(arguments.callee,d.frameTime)},d.frameTime)},o.finish=function(a){if(!p||"playing"==p.status)return!1;var b=d.end;d.end=function(a){b(a),this.stop()},this.play(a)},o.pause=function(){return p&&(p.status="pause")&&clearTimeout(p.playID),this},o.resume=function(){return p&&"pause"==p.status&&p.target&&this.play(p.target),this},o.stop=function(){p&&clearTimeout(p.playID),this.destroy()},o.destroy=function(){p=null,o=null},o}function c(a,b,c,d,e){if(!g(this,"function"))throw"Need to be called as Arithmetic.apply(this, arguments), this must be a animate algorithm";return this(a,b,c,d,e)}function d(){function a(a,b){return g(b,"function")&&(c[a]=b),this}function b(a){return c[a]||c.linear}var c={linear:function(a,b,c,d,e){return a+(c-a)*e/d},spring:function(a,b,c,d,e){return a+(c-a)*Math.sin(.5*Math.PI*e/d)},spring2:function(a,b,c,d,e){return.5*(c+a+(c-a)*Math.sin(Math.PI*(e/d-.5)))},damper:function(a,b,c,d,e){return a+d/e*Math.sin(e/d*Math.asin(e*(c-a)/d))}};return{add:a,use:b}}function e(a,b){if(-1!==a.indexOf("color")||-1!==a.indexOf("Color")){var c=/^(rgb.?\()(\d+),(\d+),(\d+)(?:,(\.?\d+))?(\))/i;if(-1!==b.indexOf("rgb")){b=h(b);var d=b.slice(4,-1).split(","),d=b.match(c).slice(1);6==d.length&&d.splice(4,1);var e=j(d,function(a,b){var c=parseFloat(b,10);return isNaN(c)?b:c});return e}var d=b.slice(1).split(""),e=["rgb("];if(3===d.length){var f=j(d,function(a,b){return parseInt(b+b,16)});return Array.prototype.push.apply(e,f),e.push(")"),e}for(var g=0,i=d.length;i>g;g++)e.push(parseInt(d[g]+d[++g],16));return e.push(")"),e}return b}function f(a,b,d,e,f){"rgba("==a[0]?"rgb("==b[0]&&(b[0]="rgba(",b.splice(4,0,"1")):"rgba"==b[0]&&(a[0]="rgba(",a.splice(4,0,"1"));var g=j(a.slice(1,-1),function(a,g){return Math.floor(c.apply(d,[g,0,b[a+1],e,f]))},[]);return a[0]+g.join(",")+a[a.length-1]}a=a||{};var g=a.is,h=a.clear,i=a.parseParam,j=a.forEach,k=a.styles,l=a.cssText,m=a.cssUnits,n=a.ani={};n.animate=b,n.algorithm=d()}(Saber),function(a){function b(a){var b=null;return b=a instanceof e?a:"object"==typeof a&&a.then?new e(a.then):c(a)}function c(a){return new e(function(c){try{return b("function"==typeof c?c(a):a),this}catch(e){return d(e),this}})}function d(a){b(a)}function e(a){this.then=a}function f(){function a(a,b){var c=f();return j.push(function(d){d.then(a,b).then(c.resolve,c.reject)}),c}function c(a){return g(b(a))}function g(a){for(var b=0;b<j.length;b++)j[b](a);return a}function h(a){return g(d(a))}var i=new e(a),j=[],k={promise:i,resolve:c,reject:h,then:a};return k}a.defer=f}(Saber);