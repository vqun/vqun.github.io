/*
 *@name     Saber.Base
 *@version  v0.1.0
 *@desc     An Easy Library used for https://vqun.github.io
 *@author   VeeQun
 *@license  MIT
 *@modified 2014-05-08
 */
!function(a){function b(a,b){if(!a)throw new Error("Need the code container");this.coder=a,b=b||{},this.codeType=e[b.codeType]&&b.codeType||"js",this.indent=b.indent||4,this.highlight(a,this.indent),this.tmpl=b.tmpl||f,this.container=b.container||null,b.container&&b.tmpl&&this.line(this.tmpl).render(b.container)}function c(a){return a=a.replace("<","&lt;"),a=a.replace(">","&gt;")}var d={string:['(")(((\\\\")?[^"\n\r]+?[^"\\\n\r]*?(\\\\")*)*)"',"(')(((\\\\')?[^'\n\r]+?[^'\\\n\r]*?(\\\\')*)*)'"],jsComment:["(/\\*([^*]|[\\\r\\\n]|(\\*+([^*/]|[\\\r\\\n])))*\\*+/)|(//.*)"],keyword:["alert","break","case","catch","continue","debugger","default","default","delete","do","eval","else","finally","for","function","if","in","instanceof","new","return","switch","this","throw","try","typeof","var","void","while","with","Object","prototype","Array","Number","String","Boolean","Null","Undefined","RegExp","Function","window","{","}","console","arguments","setTimeout","setInterval","clearTimeout","clearInterval"],method:["([\\w\\$\\_]+)\\("],object:["(([\\w\\$\\_]+)(\\.))+([\\w\\$\\_]+)?"],css:[],html:[]},e={js:1,css:1,html:1},f='<li class="line">${code}</li>';a.CodeHighlight=b,b.prototype.highlight=function(a,b){var d="",e=null,f=this.codeType;d=this.code(a),d=c(d),b=b||this.indent;for(var g="",h=0;b>h;h++)g+="Â ";d=d.replace(/\s*$/g,""),d=d.replace(/\t/gm,g),"js"===f?d=this.jsHighlight(d):"css"===f?d=this.cssHighlight(d):"html"===f&&(d=this.htmlHighlight(d)),e=d.split(/\n|\r/gm);var i=e[e.length-1];return(/^\s+$/.test(i)||!i)&&e.pop(),this.codes=e,this},b.prototype.code=function(a){if(!a)return"";var b="";if(1==a.nodeType){var c=a.tagName.toLowerCase();b="textarea"==c||"input"==c?a.value:a.innerText||a.textContent}return b},b.prototype.jsHighlight=function(a){var b=new RegExp(d.string.join("|"),"g");a=a.replace(b,function(){var a=arguments[2]||arguments[7],b=arguments[1]||arguments[6];return b+(a?'<i class="string">'+a+"</i>":"")+b});var c=new RegExp(d.jsComment.join("|"),"g");a=a.replace(c,function(a){for(var b=a.split(/[\n\r]/g),c="",d=0,e=b.length;e>d;d++)c=b[d],b[d]=c?'<i class="jsComment">'+c+"</i>":"";return b.join("\n")});var e=new RegExp("\\b("+d.keyword.join("|")+")\\b","gm");a=a.replace(e,function(a){return'<i class="keyword">'+a+"</i>"});var f=new RegExp(d.method.join("|"),"gm");a=a.replace(f,function(a,b){return'<i class="method">'+b+"</i>("});var g=new RegExp(d.object.join("|"),"gm");return a=a.replace(g,function(a){for(var b=a.split("."),c=[],d=0,e=b.length;e>d;d++)d?"."!=c[d]&&c.push('<i class="property">'+b[d]+"</i>"):c.push('<i class="object">'+b[d]+"</i>");return c.join(".")+("."==c[d-1]?".":"")})},b.prototype.cssHighlight=function(){},b.prototype.htmlHighlight=function(){},b.prototype.line=function(a){this.tmpl=a||this.tmpl||f,a=this.tmpl;for(var b=[],c=this.codes,d=0,e=c.length;e>d;d++)b.push(a.replace("${code}","<pre>"+(c[d]||" ")+"</pre>"));return this.codes=b,b=null,this},b.prototype.render=function(a){return this.container=a||this.container||document.body,a=this.container,a.className="codeHighlight",a.innerHTML=this.codes.join(""),this},b.prototype.reset=function(a){a=a||this.coder;this.highlight(a);this.line().render()},b.prototype.update=function(){this.reset(this.coder)}}(Saber);